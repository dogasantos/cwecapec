# CVE Attack Chain Query Tool

This Go program provides a comprehensive analysis of a given CVE, tracing the full attack chain from the vulnerability itself through its associated weaknesses, attack patterns, and real-world adversary techniques. It generates both a detailed console output and a rich, self-contained HTML report.

## Features

- **Complete Attack Chain**: Maps the path from CVE → CWE → CAPEC → MITRE ATT&CK.
- **Vulnerability Details**: Fetches detailed CVE information from the National Vulnerability Database (NVD), including description, CVSS scores, and references.
- **Exploit Prediction**: Retrieves the latest Exploit Prediction Scoring System (EPSS) score to assess the likelihood of exploitation.
- **EPSS Trend Graph**: The HTML report includes a 30-day historical graph of the CVE's EPSS score, showing its trend over time.
- **Threat Actor Intelligence**: Enumerates known threat actors and APT groups that leverage the identified ATT&CK techniques.
- **Red Team Testing**: Pulls in relevant tests from the Atomic Red Team repository, providing actionable commands to test your defenses against the specific ATT&CK techniques.
- **Dual Output**: Supports both a quick, detailed console view and a comprehensive, beautifully designed HTML report for sharing and documentation.
- **Local Database**: Leverages the pre-compiled JSON databases (`cwe_db.json`, `capec_db.json`, etc.) for fast and efficient mapping.

## How to Use

### 1. Prerequisites

- **Go 1.23+** installed.
- The `resources/` directory must be populated with the JSON databases generated by the `mitre-data-updater` program.

### 2. Build the Program

First, ensure you have the necessary dependency for YAML parsing:

```bash
go mod tidy
```

Then, build the executable:

```bash
go build -o cve-query cve-query.go
```

### 3. Run a Query

To run a query, use the `-cve` flag to specify the CVE ID. The output will be printed to the console by default.

**Example (Console Output):**

```bash
./cve-query -cve CVE-2021-44228
```

### 4. Generate an HTML Report

To generate a self-contained HTML report, use the `-html` flag and provide a filename.

**Example (HTML Report):**

```bash
./cve-query -cve CVE-2021-44228 -html log4shell_report.html
```

This will create a file named `log4shell_report.html` in the same directory, which you can open in any web browser.

## Sample HTML Report

The generated HTML report is designed to be clear, concise, and visually appealing. It includes:

- A header with the CVE ID and key metrics (CVSS, EPSS).
- A 30-day trend graph for the EPSS score.
- Collapsible sections for CWEs, CAPECs, ATT&CK Techniques, Threat Actors, and Atomic Red Team tests.
- Direct links to the MITRE ATT&CK website for techniques and groups.
- Code blocks for Atomic Red Team commands, ready to copy and paste.

## Deliverables

- **`cve-query.go`**: The main Go source file for the query tool.
- **`go.mod`**: The Go module file for the query tool.
- **`README.md`**: This file.
